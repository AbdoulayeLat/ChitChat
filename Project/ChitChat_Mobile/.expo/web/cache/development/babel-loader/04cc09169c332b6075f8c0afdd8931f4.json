{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport React from 'react';\nimport Colors from \"../utils/Colors.js\";\nimport ButtonCustom from \"../components/ButtonCustom.js\";\nimport { ScrollView } from 'react-native-gesture-handler';\nimport * as ImagePicker from 'expo-image-picker';\nimport { auth, firestore, storage } from \"../firebase.js\";\nimport { initializeApp, getApp } from 'firebase/app';\nimport { getAuth } from 'firebase/auth';\nimport { collection, addDoc, doc, setDoc } from \"firebase/firestore\";\nimport { ref, uploadBytes, getDownloadURL } from '@firebase/storage';\nimport { async } from '@firebase/util';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar RegistrationScreen = function RegistrationScreen(_ref) {\n  var route = _ref.route,\n      navigation = _ref.navigation;\n\n  var _React$useState = React.useState(),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      firstName = _React$useState2[0],\n      setFirstname = _React$useState2[1];\n\n  var _React$useState3 = React.useState(),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      lastName = _React$useState4[0],\n      setLastname = _React$useState4[1];\n\n  var _React$useState5 = React.useState(),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      email = _React$useState6[0],\n      setEmail = _React$useState6[1];\n\n  var _React$useState7 = React.useState(),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      password = _React$useState8[0],\n      setPassword = _React$useState8[1];\n\n  var _React$useState9 = React.useState(null),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      selectedImage = _React$useState10[0],\n      setSelectedImage = _React$useState10[1];\n\n  var phoneNumber = route.params.paramKey;\n  var token = route.params.paramToken;\n  var url = \"\";\n\n  var image = require(\"../utils/Images/profilepicture.png\");\n\n  var app = getApp();\n  var storageRef = ref(storage, 'images/ProfilePictures/' + token);\n\n  var uploadProfile = function uploadProfile(uri, imageName) {\n    var response, blob;\n    return _regeneratorRuntime.async(function uploadProfile$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(fetch(uri));\n\n          case 2:\n            response = _context.sent;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 5:\n            blob = _context.sent;\n            uploadBytes(storageRef, blob).then(function (snapshot) {\n              getURL();\n            });\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var openImagePickerAsync = function openImagePickerAsync() {\n    var permissionResult, pickerResult;\n    return _regeneratorRuntime.async(function openImagePickerAsync$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.requestMediaLibraryPermissionsAsync());\n\n          case 2:\n            permissionResult = _context2.sent;\n\n            if (!(permissionResult.granted === false)) {\n              _context2.next = 6;\n              break;\n            }\n\n            alert(\"Permission to access camera roll is required!\");\n            return _context2.abrupt(\"return\");\n\n          case 6:\n            _context2.next = 8;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              allowsEditing: true\n            }));\n\n          case 8:\n            pickerResult = _context2.sent;\n\n            if (!(pickerResult.cancelled === true)) {\n              _context2.next = 11;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 11:\n            setSelectedImage({\n              localUri: pickerResult.uri\n            });\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var getURL = function getURL() {\n    return _regeneratorRuntime.async(function getURL$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            getDownloadURL(storageRef).then(function (url) {\n              writeToDB(url);\n            });\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var writeToDB = function writeToDB(url) {\n    return _regeneratorRuntime.async(function writeToDB$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            _context4.next = 3;\n            return _regeneratorRuntime.awrap(setDoc(doc(firestore, \"users\", phoneNumber), {\n              UID: token,\n              firstName: firstName,\n              lastName: lastName,\n              email: email,\n              phoneNumber: phoneNumber,\n              profilepictureURL: url\n            }));\n\n          case 3:\n            navigation.replace('Main', {\n              paramKey: phoneNumber,\n              paramToken: token\n            });\n            _context4.next = 10;\n            break;\n\n          case 6:\n            _context4.prev = 6;\n            _context4.t0 = _context4[\"catch\"](0);\n            console.error(\"Error adding document: \", _context4.t0);\n            alert(\"Something went wrong! Please try again.ðŸ¤•\");\n\n          case 10:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[0, 6]], Promise);\n  };\n\n  if (selectedImage !== null) {\n    image = {\n      uri: selectedImage.localUri\n    };\n  }\n\n  return _jsx(KeyboardAvoidingView, {\n    behavior: Platform.OS === 'ios' ? 'padding' : null,\n    style: styles.registerScreen,\n    children: _jsxs(ScrollView, {\n      children: [_jsx(Text, {\n        style: styles.textSignup,\n        children: \"Create Your Profile\\uD83D\\uDE04\"\n      }), _jsxs(View, {\n        style: styles.signUpView,\n        children: [_jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return openImagePickerAsync();\n          },\n          children: _jsx(Image, {\n            style: styles.profilepicture,\n            source: image\n          })\n        }), _jsx(Text, {\n          style: styles.imageInfo,\n          children: \"*Click the Image to Pick your Profile Picture\"\n        }), _jsx(Text, {\n          style: styles.signUpTitle,\n          children: \"First Name\"\n        }), _jsx(TextInput, {\n          style: styles.textInput,\n          onChangeText: function onChangeText(text) {\n            return setFirstname(text);\n          },\n          placeholder: \"Chit Chat\",\n          placeholderTextColor: Colors.WHITE\n        }), _jsx(Text, {\n          style: styles.signUpTitle,\n          children: \"Last Name\"\n        }), _jsx(TextInput, {\n          style: styles.textInput,\n          onChangeText: function onChangeText(text) {\n            return setLastname(text);\n          },\n          placeholder: \"Chit Chat\",\n          placeholderTextColor: Colors.WHITE\n        }), _jsx(Text, {\n          style: styles.signUpTitle,\n          children: \"Email\"\n        }), _jsx(TextInput, {\n          style: styles.textInput,\n          onChangeText: function onChangeText(text) {\n            return setEmail(text);\n          },\n          placeholderTextColor: Colors.WHITE,\n          placeholder: \"example@email.com\",\n          keyboardType: \"email-address\"\n        }), _jsx(ButtonCustom, {\n          text: \"CREATE \\u2705\",\n          onPress: function onPress() {\n            return uploadProfile(selectedImage.localUri, token + \" Profile Picture\");\n          }\n        })]\n      })]\n    })\n  });\n};\n\nvar styles = StyleSheet.create({\n  registerScreen: {\n    flex: 1,\n    backgroundColor: Colors.BLUE\n  },\n  signUpView: {\n    alignItems: 'center'\n  },\n  signUpTitle: {\n    fontSize: 20,\n    color: Colors.Secondary,\n    fontWeight: '600'\n  },\n  textSignup: {\n    fontSize: 35,\n    color: Colors.Secondary,\n    alignSelf: 'center',\n    marginTop: '15%',\n    marginBottom: 15,\n    fontWeight: 'bold'\n  },\n  profilepicture: {\n    resizeMode: 'contain',\n    height: 150,\n    width: 150,\n    borderRadius: 40\n  },\n  imageInfo: {\n    color: Colors.GREEN,\n    marginBottom: 10\n  },\n  textInput: {\n    marginVertical: 15,\n    borderWidth: 2,\n    borderRadius: 10,\n    borderColor: Colors.WHITE_GREY,\n    color: Colors.Secondary,\n    fontSize: 20,\n    height: 40,\n    width: 300,\n    textAlign: 'center'\n  }\n});\nexport default RegistrationScreen;","map":{"version":3,"sources":["/Users/abdoulayendiaye/Desktop/ChitChat/Project/ChitChat_Mobile/screens/RegistrationScreen.js"],"names":["React","Colors","ButtonCustom","ScrollView","ImagePicker","auth","firestore","storage","initializeApp","getApp","getAuth","collection","addDoc","doc","setDoc","ref","uploadBytes","getDownloadURL","async","RegistrationScreen","route","navigation","useState","firstName","setFirstname","lastName","setLastname","email","setEmail","password","setPassword","selectedImage","setSelectedImage","phoneNumber","params","paramKey","token","paramToken","url","image","require","app","storageRef","uploadProfile","uri","imageName","fetch","response","blob","then","snapshot","getURL","openImagePickerAsync","requestMediaLibraryPermissionsAsync","permissionResult","granted","alert","launchImageLibraryAsync","allowsEditing","pickerResult","cancelled","localUri","writeToDB","UID","profilepictureURL","replace","console","error","Platform","OS","styles","registerScreen","textSignup","signUpView","profilepicture","imageInfo","signUpTitle","textInput","text","WHITE","StyleSheet","create","flex","backgroundColor","BLUE","alignItems","fontSize","color","Secondary","fontWeight","alignSelf","marginTop","marginBottom","resizeMode","height","width","borderRadius","GREEN","marginVertical","borderWidth","borderColor","WHITE_GREY","textAlign"],"mappings":"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","sourcesContent":["import { View, Text, TextInput, StyleSheet, Platform, TouchableOpacity, KeyboardAvoidingView, Image, SafeAreaView, Button, Alert} from 'react-native';\nimport React from 'react';\nimport Colors from '../utils/Colors.js';\nimport ButtonCustom from '../components/ButtonCustom.js';\nimport { ScrollView } from 'react-native-gesture-handler';\nimport * as ImagePicker from 'expo-image-picker';\nimport { auth, firestore, storage } from '../firebase.js';\nimport { initializeApp, getApp } from 'firebase/app';\nimport { getAuth } from 'firebase/auth';\nimport { collection, addDoc, doc, setDoc } from \"firebase/firestore\"; \nimport { ref, uploadBytes, getDownloadURL } from '@firebase/storage';\nimport { async } from '@firebase/util';\n\nconst RegistrationScreen = ({route ,navigation}) => {\n  const [firstName, setFirstname] = React.useState();\n  const [lastName, setLastname] = React.useState();\n  const [email, setEmail] = React.useState();\n  const [password, setPassword] = React.useState();\n  const [selectedImage, setSelectedImage] = React.useState(null);\n  const phoneNumber = route.params.paramKey;\n  const token = route.params.paramToken;\n  var url = \"\";\n  var image = require('../utils/Images/profilepicture.png');\n  \n  const app = getApp();\n  const storageRef = ref(storage, 'images/ProfilePictures/'+token);\n  \n  \n  let uploadProfile = async (uri, imageName) => {\n    const response = await fetch(uri);\n    const blob = await response.blob();\n\n    uploadBytes(storageRef, blob).then((snapshot) => {\n      getURL();\n    });\n  }\n\n  // Image Pick\n  let openImagePickerAsync = async () => {\n    let permissionResult = await ImagePicker.requestMediaLibraryPermissionsAsync();\n    \n    if (permissionResult.granted === false) {\n      alert(\"Permission to access camera roll is required!\");\n      return;\n    }\n    let pickerResult = await ImagePicker.launchImageLibraryAsync({\n      allowsEditing: true\n    });\n    if (pickerResult.cancelled === true) {\n      return;\n    }\n    setSelectedImage({ localUri: pickerResult.uri }); \n  }\n\n  let getURL = async () => {\n    getDownloadURL(storageRef).then((url) => {\n      writeToDB(url);\n    });\n  }\n\n\n  let writeToDB = async (url) => {\n    try {\n        await setDoc(doc(firestore, \"users\", phoneNumber), {\n          UID: token,\n          firstName: firstName,\n          lastName: lastName,\n          email: email,\n          phoneNumber: phoneNumber,\n          profilepictureURL: url,\n        });\n        navigation.replace('Main', { \n            paramKey: phoneNumber,\n            paramToken: token\n        });\n    } catch (e) {\n        console.error(\"Error adding document: \", e);\n        alert(\"Something went wrong! Please try again.ðŸ¤•\")\n      }\n  }\n  \n  if (selectedImage !== null) {\n    image = { uri: selectedImage.localUri }\n  }\n\n  return (\n    <KeyboardAvoidingView\n      behavior={Platform.OS === 'ios' ? 'padding':null}\n      style={styles.registerScreen}\n    >\n      <ScrollView>\n            <Text style={styles.textSignup}>Create Your ProfileðŸ˜„</Text>\n            <View style={styles.signUpView}>\n\n              <TouchableOpacity onPress={() => openImagePickerAsync()}>\n                <Image style={styles.profilepicture} source={image}/>\n              </TouchableOpacity>\n\n              <Text style={styles.imageInfo}>*Click the Image to Pick your Profile Picture</Text>\n              \n              <Text style={styles.signUpTitle}>First Name</Text>\n              <TextInput  style={styles.textInput} onChangeText={text => setFirstname(text)} placeholder={\"Chit Chat\"} placeholderTextColor = {Colors.WHITE}/>\n\n              <Text style={styles.signUpTitle}>Last Name</Text>\n              <TextInput  style={styles.textInput} onChangeText={text => setLastname(text)} placeholder={\"Chit Chat\"} placeholderTextColor = {Colors.WHITE}/>  \n\n              <Text style={styles.signUpTitle}>Email</Text>\n              <TextInput style={styles.textInput} onChangeText={text => setEmail(text)} placeholderTextColor = {Colors.WHITE} placeholder={\"example@email.com\"} keyboardType={\"email-address\"}/>\n              \n              <ButtonCustom text='CREATE âœ…' onPress={() => uploadProfile(selectedImage.localUri, token+\" Profile Picture\")}/>\n            </View>\n      </ScrollView>\n    </KeyboardAvoidingView>\n  );\n};\n\nconst styles = StyleSheet.create({\n    registerScreen:{\n        flex:1,\n        backgroundColor: Colors.BLUE,\n    },\n    signUpView:{\n      alignItems: 'center',\n    },\n    signUpTitle:{\n      fontSize: 20,\n      color: Colors.Secondary,\n      fontWeight: '600',\n    },\n    textSignup:{\n        fontSize: 35,\n        color: Colors.Secondary,\n        alignSelf: 'center',\n        marginTop: '15%',\n        marginBottom: 15,\n        fontWeight: 'bold'\n    },\n    profilepicture:{\n      resizeMode: 'contain',\n      height: 150,\n      width: 150,\n      borderRadius: 40,\n    },\n    imageInfo:{\n      color: Colors.GREEN,\n      marginBottom: 10,\n    },\n    textInput:{\n      marginVertical: 15,\n      borderWidth:2,\n      borderRadius:10,\n      borderColor: Colors.WHITE_GREY,\n      color: Colors.Secondary,\n      fontSize: 20,\n      height: 40,\n      width: 300,\n      textAlign: 'center'\n    },\n});\n\nexport default RegistrationScreen;\n"]},"metadata":{},"sourceType":"module"}