(function () {function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function f(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}window.onload=function(){firebase.initializeApp({apiKey:"AIzaSyAK9o-m9i97W--01XikQipHNUV4EQfdIM8",authDomain:"chit-cae27.firebaseapp.com",databaseURL:"https://chit-cae27-default-rtdb.firebaseio.com",projectId:"chit-cae27",storageBucket:"chit-cae27.appspot.com",messagingSenderId:"749327233673",appId:"1:749327233673:web:f182f17c238213d4320c58",measurementId:"G-WT8ML4X9HT"});var e=firebase.database(),t=new(function(){function t(){d(this,t)}return f(t,[{key:"home",value:function(){document.body.innerHTML="",this.create_title(),this.create_join_form()}},{key:"chat",value:function(){this.create_title(),this.create_chat()}},{key:"create_title",value:function(){var e=document.createElement("div");e.setAttribute("id","title_container");var t=document.createElement("div");t.setAttribute("id","title_inner_container");var n=document.createElement("h1");n.setAttribute("id","title"),n.textContent="ChitChat",t.append(n),e.append(t),document.body.append(e)}},{key:"create_join_form",value:function(){var e=this,t=document.createElement("div");t.setAttribute("id","join_container");var n=document.createElement("div");n.setAttribute("id","join_inner_container");var a=document.createElement("div");a.setAttribute("id","join_button_container");var i=document.createElement("button");i.setAttribute("id","join_button"),i.innerHTML="Join <i class=\"fas fa-sign-in-alt\"></i>";var c=document.createElement("div");c.setAttribute("id","join_input_container");var r=document.createElement("input");r.setAttribute("id","join_input"),r.setAttribute("maxlength",15),r.placeholder="No.... It's Patrick Star",r.onkeyup=function(){r.value.length>0?(i.classList.add("enabled"),i.onclick=function(){e.save_name(r.value),t.remove(),e.create_chat()}):i.classList.remove("enabled")},a.append(i),c.append(r),n.append(c,a),t.append(n),document.body.append(t)}},{key:"create_load",value:function(e){var t=document.getElementById(e);t.innerHTML="";var n=document.createElement("div");n.setAttribute("class","loader_container");var a=document.createElement("div");a.setAttribute("class","loader"),n.append(a),t.append(n)}},{key:"create_chat",value:function(){var e=this,t=document.getElementById("title_container"),n=document.getElementById("title");t.classList.add("chat_title_container"),n.classList.add("chat_title");var a=document.createElement("div");a.setAttribute("id","chat_container");var i=document.createElement("div");i.setAttribute("id","chat_inner_container");var c=document.createElement("div");c.setAttribute("id","chat_content_container");var r=document.createElement("div");r.setAttribute("id","chat_input_container");var o=document.createElement("button");o.setAttribute("id","chat_input_send"),o.setAttribute("disabled",!0),o.innerHTML="<i class=\"far fa-paper-plane\"></i>";var s=document.createElement("input");s.setAttribute("id","chat_input"),s.setAttribute("maxlength",1e3),s.placeholder="".concat(e.get_name(),". Say something..."),s.onkeyup=function(){s.value.length>0?(o.removeAttribute("disabled"),o.classList.add("enabled"),o.onclick=function(){o.setAttribute("disabled",!0),o.classList.remove("enabled"),s.value.length<=0||(e.create_load("chat_content_container"),e.send_message(s.value),s.value="",s.focus())}):o.classList.remove("enabled")};var l=document.createElement("div");l.setAttribute("id","chat_logout_container");var u=document.createElement("button");u.setAttribute("id","chat_logout"),u.textContent="".concat(e.get_name()," \u2022 logout"),u.onclick=function(){localStorage.clear(),e.home()},l.append(u),r.append(s,o),i.append(c,r,l),a.append(i),document.body.append(a),e.create_load("chat_content_container"),e.refresh_chat()}},{key:"save_name",value:function(e){localStorage.setItem("name",e)}},{key:"send_message",value:function(t){var n=this;null==n.get_name()&&null==t||e.ref("chats/").once("value",function(a){var i=parseFloat(a.numChildren())+1;e.ref("chats/"+"message_".concat(i)).set({name:n.get_name(),message:t,index:i}).then(function(){n.refresh_chat()})})}},{key:"get_name",value:function(){return null!=localStorage.getItem("name")?localStorage.getItem("name"):(this.home(),null)}},{key:"refresh_chat",value:function(){var t=document.getElementById("chat_content_container");e.ref("chats/").on("value",function(e){if(t.innerHTML="",0!=e.numChildren()){for(var n=Object.values(e.val()),a=[],i=[],c=[],r=0;r<n.length;r++)a.push(r+1),i.push([n[r],n[r].index]);a.forEach(function(e){var t=!1;i=i.filter(function(n){return!(!t&&n[1]==e)||(c.push(n[0]),t=!0,!1)})}),c.forEach(function(e){var n=e.name,a=e.message,i=document.createElement("div");i.setAttribute("class","message_container");var c=document.createElement("div");c.setAttribute("class","message_inner_container");var r=document.createElement("div");r.setAttribute("class","message_user_container");var o=document.createElement("p");o.setAttribute("class","message_user"),o.textContent="".concat(n);var s=document.createElement("div");s.setAttribute("class","message_content_container");var l=document.createElement("p");l.setAttribute("class","message_content"),l.textContent="".concat(a),r.append(o),s.append(l),c.append(r,s),i.append(c),t.append(i)}),t.scrollTop=t.scrollHeight}})}}]),t}());null!=t.get_name()&&t.chat()};})();