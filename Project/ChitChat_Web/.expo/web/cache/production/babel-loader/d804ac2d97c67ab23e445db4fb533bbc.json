{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";var _excluded=[\"containerStyle\"],_excluded2=[\"containerStyle\"],_excluded3=[\"containerStyle\"],_excluded4=[\"containerStyle\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import PropTypes from'prop-types';import React from'react';import View from\"react-native-web/dist/exports/View\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Avatar from\"./Avatar\";import Bubble from\"./Bubble\";import SystemMessage from\"./SystemMessage\";import Day from\"./Day\";import{StylePropType,isSameUser}from\"./utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var styles={left:StyleSheet.create({container:{flexDirection:'row',alignItems:'flex-end',justifyContent:'flex-start',marginLeft:8,marginRight:0}}),right:StyleSheet.create({container:{flexDirection:'row',alignItems:'flex-end',justifyContent:'flex-end',marginLeft:0,marginRight:8}})};var Message=function(_React$Component){_inherits(Message,_React$Component);var _super=_createSuper(Message);function Message(){_classCallCheck(this,Message);return _super.apply(this,arguments);}_createClass(Message,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps){var next=nextProps.currentMessage;var current=this.props.currentMessage;var _this$props=this.props,previousMessage=_this$props.previousMessage,nextMessage=_this$props.nextMessage;var nextPropsMessage=nextProps.nextMessage;var nextPropsPreviousMessage=nextProps.previousMessage;var shouldUpdate=this.props.shouldUpdateMessage&&this.props.shouldUpdateMessage(this.props,nextProps)||false;return next.sent!==current.sent||next.received!==current.received||next.pending!==current.pending||next.createdAt!==current.createdAt||next.text!==current.text||next.image!==current.image||next.video!==current.video||next.audio!==current.audio||previousMessage!==nextPropsPreviousMessage||nextMessage!==nextPropsMessage||shouldUpdate;}},{key:\"renderDay\",value:function renderDay(){if(this.props.currentMessage&&this.props.currentMessage.createdAt){var _this$props2=this.props,containerStyle=_this$props2.containerStyle,props=_objectWithoutProperties(_this$props2,_excluded);if(this.props.renderDay){return this.props.renderDay(props);}return _jsx(Day,_objectSpread({},props));}return null;}},{key:\"renderBubble\",value:function renderBubble(){var _this$props3=this.props,containerStyle=_this$props3.containerStyle,props=_objectWithoutProperties(_this$props3,_excluded2);if(this.props.renderBubble){return this.props.renderBubble(props);}return _jsx(Bubble,_objectSpread({},props));}},{key:\"renderSystemMessage\",value:function renderSystemMessage(){var _this$props4=this.props,containerStyle=_this$props4.containerStyle,props=_objectWithoutProperties(_this$props4,_excluded3);if(this.props.renderSystemMessage){return this.props.renderSystemMessage(props);}return _jsx(SystemMessage,_objectSpread({},props));}},{key:\"renderAvatar\",value:function renderAvatar(){var _this$props5=this.props,user=_this$props5.user,currentMessage=_this$props5.currentMessage,showUserAvatar=_this$props5.showUserAvatar;if(user&&user._id&&currentMessage&&currentMessage.user&&user._id===currentMessage.user._id&&!showUserAvatar){return null;}if(currentMessage&&currentMessage.user&&currentMessage.user.avatar===null){return null;}var _this$props6=this.props,containerStyle=_this$props6.containerStyle,props=_objectWithoutProperties(_this$props6,_excluded4);return _jsx(Avatar,_objectSpread({},props));}},{key:\"render\",value:function render(){var _this$props7=this.props,currentMessage=_this$props7.currentMessage,nextMessage=_this$props7.nextMessage,position=_this$props7.position,containerStyle=_this$props7.containerStyle;if(currentMessage){var sameUser=isSameUser(currentMessage,nextMessage);return _jsxs(View,{children:[this.renderDay(),currentMessage.system?this.renderSystemMessage():_jsxs(View,{style:[styles[position].container,{marginBottom:sameUser?2:10},!this.props.inverted&&{marginBottom:2},containerStyle&&containerStyle[position]],children:[this.props.position==='left'?this.renderAvatar():null,this.renderBubble(),this.props.position==='right'?this.renderAvatar():null]})]});}return null;}}]);return Message;}(React.Component);export{Message as default};Message.defaultProps={renderAvatar:undefined,renderBubble:null,renderDay:null,renderSystemMessage:null,position:'left',currentMessage:{},nextMessage:{},previousMessage:{},user:{},containerStyle:{},showUserAvatar:false,inverted:true,shouldUpdateMessage:undefined};Message.propTypes={renderAvatar:PropTypes.func,showUserAvatar:PropTypes.bool,renderBubble:PropTypes.func,renderDay:PropTypes.func,renderSystemMessage:PropTypes.func,position:PropTypes.oneOf(['left','right']),currentMessage:PropTypes.object,nextMessage:PropTypes.object,previousMessage:PropTypes.object,user:PropTypes.object,inverted:PropTypes.bool,containerStyle:PropTypes.shape({left:StylePropType,right:StylePropType}),shouldUpdateMessage:PropTypes.func};","map":{"version":3,"sources":["../src/Message.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import PropTypes from 'prop-types';\nimport React from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport Avatar from './Avatar';\nimport Bubble from './Bubble';\nimport SystemMessage from './SystemMessage';\nimport Day from './Day';\nimport { StylePropType, isSameUser } from './utils';\nconst styles = {\n    left: StyleSheet.create({\n        container: {\n            flexDirection: 'row',\n            alignItems: 'flex-end',\n            justifyContent: 'flex-start',\n            marginLeft: 8,\n            marginRight: 0,\n        },\n    }),\n    right: StyleSheet.create({\n        container: {\n            flexDirection: 'row',\n            alignItems: 'flex-end',\n            justifyContent: 'flex-end',\n            marginLeft: 0,\n            marginRight: 8,\n        },\n    }),\n};\nexport default class Message extends React.Component {\n    shouldComponentUpdate(nextProps) {\n        const next = nextProps.currentMessage;\n        const current = this.props.currentMessage;\n        const { previousMessage, nextMessage } = this.props;\n        const nextPropsMessage = nextProps.nextMessage;\n        const nextPropsPreviousMessage = nextProps.previousMessage;\n        const shouldUpdate = (this.props.shouldUpdateMessage &&\n            this.props.shouldUpdateMessage(this.props, nextProps)) ||\n            false;\n        return (next.sent !== current.sent ||\n            next.received !== current.received ||\n            next.pending !== current.pending ||\n            next.createdAt !== current.createdAt ||\n            next.text !== current.text ||\n            next.image !== current.image ||\n            next.video !== current.video ||\n            next.audio !== current.audio ||\n            previousMessage !== nextPropsPreviousMessage ||\n            nextMessage !== nextPropsMessage ||\n            shouldUpdate);\n    }\n    renderDay() {\n        if (this.props.currentMessage && this.props.currentMessage.createdAt) {\n            const { containerStyle, ...props } = this.props;\n            if (this.props.renderDay) {\n                return this.props.renderDay(props);\n            }\n            return <Day {...props}/>;\n        }\n        return null;\n    }\n    renderBubble() {\n        const { containerStyle, ...props } = this.props;\n        if (this.props.renderBubble) {\n            return this.props.renderBubble(props);\n        }\n        // @ts-ignore\n        return <Bubble {...props}/>;\n    }\n    renderSystemMessage() {\n        const { containerStyle, ...props } = this.props;\n        if (this.props.renderSystemMessage) {\n            return this.props.renderSystemMessage(props);\n        }\n        return <SystemMessage {...props}/>;\n    }\n    renderAvatar() {\n        const { user, currentMessage, showUserAvatar } = this.props;\n        if (user &&\n            user._id &&\n            currentMessage &&\n            currentMessage.user &&\n            user._id === currentMessage.user._id &&\n            !showUserAvatar) {\n            return null;\n        }\n        if (currentMessage &&\n            currentMessage.user &&\n            currentMessage.user.avatar === null) {\n            return null;\n        }\n        const { containerStyle, ...props } = this.props;\n        return <Avatar {...props}/>;\n    }\n    render() {\n        const { currentMessage, nextMessage, position, containerStyle } = this.props;\n        if (currentMessage) {\n            const sameUser = isSameUser(currentMessage, nextMessage);\n            return (<View>\n          {this.renderDay()}\n          {currentMessage.system ? (this.renderSystemMessage()) : (<View style={[\n                styles[position].container,\n                { marginBottom: sameUser ? 2 : 10 },\n                !this.props.inverted && { marginBottom: 2 },\n                containerStyle && containerStyle[position],\n            ]}>\n              {this.props.position === 'left' ? this.renderAvatar() : null}\n              {this.renderBubble()}\n              {this.props.position === 'right' ? this.renderAvatar() : null}\n            </View>)}\n        </View>);\n        }\n        return null;\n    }\n}\nMessage.defaultProps = {\n    renderAvatar: undefined,\n    renderBubble: null,\n    renderDay: null,\n    renderSystemMessage: null,\n    position: 'left',\n    currentMessage: {},\n    nextMessage: {},\n    previousMessage: {},\n    user: {},\n    containerStyle: {},\n    showUserAvatar: false,\n    inverted: true,\n    shouldUpdateMessage: undefined,\n};\nMessage.propTypes = {\n    renderAvatar: PropTypes.func,\n    showUserAvatar: PropTypes.bool,\n    renderBubble: PropTypes.func,\n    renderDay: PropTypes.func,\n    renderSystemMessage: PropTypes.func,\n    position: PropTypes.oneOf(['left', 'right']),\n    currentMessage: PropTypes.object,\n    nextMessage: PropTypes.object,\n    previousMessage: PropTypes.object,\n    user: PropTypes.object,\n    inverted: PropTypes.bool,\n    containerStyle: PropTypes.shape({\n        left: StylePropType,\n        right: StylePropType,\n    }),\n    shouldUpdateMessage: PropTypes.func,\n};\n//# sourceMappingURL=Message.js.map"]},"metadata":{},"sourceType":"module"}